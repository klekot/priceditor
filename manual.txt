Руководство пользователя.

Программа "Price Editor" предназначена для управления определённым содержимым сайта www.poligon.info посредством внесения изменений в xls-файл, содержащий как прайс-лист, так и данные для размещения на сайте, такие, как описания товаров, пути размещения иллюстраций, PDF-файлов с характеристиками и html-разметка.
Загружается файл в программу путем выбора в меню пунктов "Файл" и "Открыть".
Все изменения, произведённые во время работы с программой, будут записаны в файл прайс-листа ТОЛЬКО ПОСЛЕ его сохранения через пункт меню "Файл" и далее "Сохранить".
Для работы с другой версией файла прайс-листа необходимо закрыть файл, открытый ранее. Это делается через меню "Файл" - "Закрыть".
Для выхода из программы надо выбрать в меню "Файл" подпункт "Выход".

Пользовательский интерфейс представляет собой рабочее окно неизменного размера, элементы которого сгруппированы по функционалу. В левой части сосредоточены элементы для выбора редактируемой позиции, в правой - для осуществления редакции.
Выбор позиции может быть произведён двумя способами:
1) Ввести в верхнее левое текстовое поле наименование позиции, после чего нажать на кнопку "Поиск по наименованию".
Это поле обладает функцией автодополнения, то есть когда пользователь начинает ввод текста, ему предлагаются варианты из тех, что содержатся в файле прайс-листа. Можно набрать несколько символов названия искомой позиции, а далее перемещаться по всем возможным вариантам с помощью клавиш "Стрелка верх" и "Стрелка вниз" на клавиатуре. После того, как позиция обнаружена, следует нажать на кнопку "Поиск по наименованию", либо нажать "Enter" на клавиатуре, после чего программа запустит процесс обработки запроса. Будет построено иерархическое дерево категорий, содержащих данную позицию, список всех позиций в выбранной категории, а также актуальное изображение позиции, загруженное с сайта www.poligon.info
2) При загрузке в программу файла прайс-листа автоматически выводится верхний уровень иерархии всего содержимого. Двойным кликом по нужной категории вызываются её под-категории, а в списке справа от категорий выводятся все позиции, которые в ней содержатся. Кликнув двойным щелчком по нужной позиции пользователь получает доступ к её редактированию.

По умолчанию, в списке элементов выбранной категории красным шрифтом выделяются те позиции, у которых не заполнены "Технические характеристики". Этот режим отображения можно отключить в меню "Опции" - "Скрывать незаполненные позиции". Это действие произведёт изменения только после выбора следующей позиции или элемента каталога. С отключением этой опции скорость обработки несколько возрастает, так как упрощаются алгоритмы расчёта данных. Обратное действие возможно вызвать из меню "Опции" - "Показывать незаполненные позиции".

Правая часть интерфейса представляет текстовое поле с вкладками над ним. Выбирая ту или иную вкладку можно отредактировать описание и набор иллюстраций для каждой позиции в каталоге. Рассмотрим назначение каждой вкладки:

Вкладка "Общее описание" позволяет отредактировать текстовое содержимое эквивалентной вкладки представления элемента каталога на сайте. У этой вкладки есть специфическая особенность: если вводить пункты описания через запятую, то программа сама преобразует такой текст в html-список и отобразит на сайте в едином стиле, определённом текущим файлом CSS. Если же пользователь лично сформирует html-список тегами "<li></li>", то автоматическое преобразование не включится и текст опубликуется на сайте с учётом пользовательского форматирования. ВНИМАНИЕ! Нет необходимости формировать список в описании позиции тегом "<ul>", поскольку программа сама подставляет эти теги с правильной привязкой к классам стилей, используемых в оформлении сайта.

Вкладка "Тех. хар-ки" соответствует вкладке "Технические характеристики" в представлении элемента категории на сайте и содержит html-разметку, доступную для редактирования.

Вкладки "Схема №1", "Схема №2" и "Габариты" позволяют выбрать иллюстрации для отображения в соответствующих вкладках на сайте. В текстовое поле "Файл с картинкой" выводится путь к файлу изображения на сервере, причём общая для всех картинок часть пути (http://www.poligon.info/images/) явным образом не прописывается. Для того, чтобы разместить или изменить картинку надо воспользоваться кнопкой выбора файла "Открыть". При нажатии на кнопку "Сохранить" файл с изображением отправится на сервер по пути, установленному правилами размещения файлов на сервере. Кроме того, программа самостоятельно сгенерирует стандартизованное имя для этого изображения, основываясь на названии позиции, к которой оно относится, а также его назначении (например, для картинок с габаритами добавится суффикс "_dim").

Вкладка "Спец. объявление" позволяет вывести на странице элемента каталога перед отображением вкладок с описанием и характеристиками важное объявление, относящееся только к данному элементу. Здесь можно использовать html-теги для наиболее желаемого форматирования текста.

Вкладка "Общий шаблон" содержит html-шаблон всего блока элемента каталога, который сохраняется в базе данных для последующего отображения на сайте через систему "Битрикс". По умолчанию эта вкладка неактивна из соображений предохранения от случайного изменения файла шаблона. Активировать её можно через меню "Опции" - "Активировать вкладку "Общий шаблон". Этот шаблон крайне чувствителен к изменениям, например, перенос части строки на другую строку повлечёт разрушение всего представления. Дело в  том, что данный шаблон содержит спецификаторы {% name %}, {% attention %}, {% short %}, {% params %}, {% schm1 %}, {% schm2 %}, {% dim %}, {% pdf %}, на место которых во время работы программы специально разработанный интерпретатор подставляет соответствующее содержимое, считывая файл шаблона построчно. Поэтому ОЧЕНЬ НЕ РЕКОМЕНДУЕТСЯ вносить спонтанные правки в существующий шаблон, во избежание проблем в работе сайта. Если же изменения в шаблоне необходимы, то для их применения необходимо зайти в меню "Опции" и там выбрать пункт "Обновить дизайн всех элементов". 

Под текстовым полем с вкладками находятся поля для размещения и изменения основного изображения элемента каталога и прикреплённого к элементу файла PDF. Операции с этими полями полностью аналогичны работе с изображениями на вкладках "Схема №1", "Схема №2" и "Габариты".

В нижней части окна содержится визуализация положения редактируемого элемента в иерархии каталога, локальный путь к файлу прайс-листа, с которым работает пользователь, чек-бокс "Запись в БД", а также кнопки "Применить изменения" и "Вывести в браузер". По умолчанию изменения, произведённые в ходе редактирования, сохраняются в оперативной памяти, куда помещаются путём нажатия на кнопку "Применить изменения". Это позволяет организовать локальный предпросмотр внесённых изменений в браузере, без отправки изменений на сервер. Нажатие на кнопку "Вывести в браузер" формирует html-страницу с текущим содержимым позиции и выводит его в дефолтный браузер с сохранением стилей, используемых на сайте. Если пользователь удовлетворён результатом, все изменения вносятся в файл прайс-листа при сохранении через меню "Файл" - "Сохранить".

В случае, когда необходима срочная корректировка в отображении элемента на сайте, например, анонс, исправление ошибки и прочее, можно воспользоваться функцией "Запись в БД". Когда этот чек-бокс выбран, нажатие на кнопку "Применить изменения" приведёт к прямой записи внесённых изменений в Базу Данных, из которой они сразу попадут на сайт. Для того, чтобы увидеть эти изменения, возможно, потребуется обновить кэш браузера. Пользователь может выбрать нужную БД в меню "Настройки" - "Выбор БД". По умолчанию программа соединяется с БД сайта www.poligon.info.